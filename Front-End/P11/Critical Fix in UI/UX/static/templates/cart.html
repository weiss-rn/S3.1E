<!DOCTYPE html>
<html lang="en">
<head>
    <title>Keranjang - Mobile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='CSS/dark.css') }}">
    <style>
        body {
            background: #f5f7fb;
            font-family: "Inter", system-ui, -apple-system, sans-serif;
        }

        .cart-card {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 12px;
            background: #fff;
        }

        .item-thumb {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 10px;
            border: 1px solid #eee;
        }

        .summary {
            border: 1px dashed #cbd5e1;
            border-radius: 10px;
            background: #f8fafc;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark shadow-sm py-2">
        <div class="container d-flex justify-content-between">
            <a class="navbar-brand fw-bold fs-5" href="/">Stikom Mart</a>
            <button id="darkModeToggle" class="btn btn-outline-light btn-sm">Dark Mode</button>
        </div>
    </nav>
    <div class="container mt-3">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="fw-bold mb-0">Keranjang</h5>
            <a href="/" class="text-decoration-none text-primary small"><i class="fas fa-chevron-left me-1"></i>Belanja lagi</a>
        </div>
        {% if cart_items %}
            <div class="d-flex flex-column gap-2">
                {% for item in cart_items %}
                    <div class="cart-card d-flex align-items-center gap-3">
                        <img src="{{ url_for('static', filename='img/' ~ item.image) if item.image else 'https://via.placeholder.com/120x120?text=Produk' }}" alt="{{ item.name }}" class="item-thumb">
                        <div class="flex-fill">
                            <div class="fw-semibold small mb-1 text-truncate">{{ item.name }}</div>
                            <div class="text-primary fw-bold">Rp {{ "%.0f"|format(item.price) }}</div>
                        </div>
                        <a href="/add_to_cart/{{ item.id }}" class="btn btn-outline-secondary btn-sm">Tambah</a>
                    </div>
                {% endfor %}
            </div>
            <div class="summary p-3 mt-3">
                <div class="d-flex justify-content-between">
                    <span class="text-muted">Total</span>
                    <strong>Rp {{ cart_items | map(attribute='price') | sum | round(0, 'floor') | int }}</strong>
                </div>
            </div>
            <div class="d-grid gap-2 mt-3">
                <a href="/checkout" class="btn btn-success py-2">Lanjut Checkout</a>
            </div>
        {% else %}
            <div class="alert alert-light text-center small">Keranjang Anda kosong.</div>
        {% endif %}
    </div>
    <script>
        const body = document.body;
        const toggle = document.getElementById("darkModeToggle");

        if (localStorage.getItem("darkMode") === "enabled") {
            enableDarkMode();
        }

        toggle.addEventListener("click", () => {
            if (body.classList.contains("dark-mode")) {
                disableDarkMode();
            } else {
                enableDarkMode();
            }
        });

        function enableDarkMode() {
            body.classList.add("dark-mode");
            document.querySelectorAll(".navbar, .cart-card, .summary")
                .forEach(el => el.classList.add("dark-mode"));
            localStorage.setItem("darkMode", "enabled");
            toggle.innerHTML = "Dark";
        }

        function disableDarkMode() {
            body.classList.remove("dark-mode");
            document.querySelectorAll(".navbar, .cart-card, .summary")
                .forEach(el => el.classList.remove("dark-mode"));
            localStorage.setItem("darkMode", "disabled");
            toggle.innerHTML = "Light";
        }
    </script>
</body>
</html>
