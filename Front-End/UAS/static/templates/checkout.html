{% extends "base.html" %}
{% block title %}Checkout - MotoSpare Mart{% endblock %}

{% block content %}
<div class="checkout-page">
    <!-- Checkout Summary Header -->
    <div class="checkout-summary mb-4">
        <!-- Step Indicator -->
        <div class="step-indicator mb-4">
            <span>1. Keranjang</span>
            <i class="fas fa-chevron-right text-muted" style="font-size: 0.8rem;"></i>
            <span class="active">2. Checkout</span>
            <i class="fas fa-chevron-right text-muted" style="font-size: 0.8rem;"></i>
            <span>3. Selesai</span>
        </div>

        <!-- Success Message -->
        <div class="text-center py-3">
            <div class="thankyou-icon mx-auto mb-3">
                <i class="fas fa-check"></i>
            </div>
            <h5 class="fw-bold mb-2">Checkout Berhasil!</h5>
            <p class="text-muted small mb-0">
                Terima kasih sudah memilih MotoSpare Mart. Berikut detail pemesanan Anda:
            </p>
        </div>
    </div>

{% if products %}
    {% set order_total = products | map(attribute='price') | sum | round(0, 'floor') | int %}

    <!-- Order Items -->
    <div class="card-soft mb-4">
        <h6 class="fw-bold mb-3">
            <i class="fas fa-box me-2" style="color: var(--primary);"></i>Item Pesanan
        </h6>
        {% for product in products %}
            <div class="d-flex justify-content-between align-items-center py-3 {% if not loop.last %}border-bottom{% endif %}">
                <div class="d-flex align-items-center gap-3">
                    <div class="thumb-icon">
                        <i class="fas fa-box text-muted"></i>
                    </div>
                    <div>
                        <div class="fw-semibold">{{ product.name }}</div>
                        <div class="text-muted small">Rp {{ "{:,}".format(product.price | round(0, 'floor') | int).replace(",", ".") }}</div>
                    </div>
                </div>
                <span class="badge bg-success text-white">1 pcs</span>
            </div>
        {% endfor %}
    </div>

    <!-- Order Total -->
    <div class="card-soft mb-4" style="background: var(--primary-50); border-color: rgba(249, 115, 22, 0.2);">
        <div class="d-flex justify-content-between align-items-center">
            <span class="fw-semibold" style="color: var(--primary-dark);">Total Order</span>
            <strong class="fs-4" style="color: var(--primary);">Rp {{ "{:,}".format(order_total).replace(",", ".") }}</strong>
        </div>
    </div>

    <!-- Order Info -->
    <div class="info-card mb-4">
        <h6 class="fw-bold mb-3">
            <i class="fas fa-info-circle me-2" style="color: var(--primary);"></i>Informasi Pesanan
        </h6>
        <div class="d-flex flex-wrap gap-2 mb-3">
            <span class="feature-badge">
                <i class="fas fa-truck me-1"></i>Dikirim hari ini (jika sebelum jam 14.00)
            </span>
            <span class="feature-badge">
                <i class="fas fa-shield-alt me-1"></i>Garansi 7 hari
            </span>
        </div>
        <div class="text-muted small">
            <i class="fas fa-headset me-1"></i>
            Butuh bantuan? Hubungi tim kami via WhatsApp di jam kerja.
        </div>
    </div>

    <!-- Thank You Message -->
    <div class="info-card mb-4 text-center" style="background: var(--success-bg); border-color: var(--success);">
        <div class="mb-2">
            <i class="fas fa-heart text-success" style="font-size: 1.5rem;"></i>
        </div>
        <h6 class="fw-bold mb-1" style="color: var(--success);">Terima Kasih!</h6>
        <p class="small text-muted mb-0">
            Pesanan Anda sedang diproses. Kami akan mengirimkan konfirmasi pengiriman dalam waktu singkat.
        </p>
    </div>
{% else %}
    <!-- Empty State -->
    <div class="empty-state text-center py-5">
        <div class="empty-icon mx-auto" style="background: var(--warning-bg); border-color: var(--warning); color: var(--warning);">
            <i class="fas fa-box-open"></i>
        </div>
        <h6 class="fw-bold fs-5 mb-2">Tidak ada item untuk checkout</h6>
        <p class="text-muted small mb-4">
            Tambahkan produk ke keranjang terlebih dulu.
        </p>
        <a href="{{ url_for('index') }}" class="btn btn-primary btn-sm py-2">
            <i class="fas fa-shopping-cart me-1"></i>Kembali Belanja
        </a>
    </div>
{% endif %}

<!-- Back to Home Button -->
<div class="d-grid gap-2 mt-4">
    <a href="{{ url_for('index') }}" class="btn btn-outline-secondary py-2">
        <i class="fas fa-home me-1"></i>Kembali ke Beranda
    </a>
    <a href="{{ url_for('category', slug='semua') }}" class="btn btn-primary py-2">
        <i class="fas fa-th-large me-1"></i>Lihat Produk Lain
    </a>
</div>
</div>
{% endblock %}

{% block bottom %}
<nav class="bottom-nav" aria-label="Navigasi bawah">
    <a href="{{ url_for('index') }}" class="{{ 'active' if request.path == '/' else '' }}">
        <i class="fas fa-home"></i>
        <span>Home</span>
    </a>
    <a href="{{ url_for('category', slug='semua') }}" class="{{ 'active' if request.path.startswith('/kategori') else '' }}">
        <i class="fas fa-th-large"></i>
        <span>Kategori</span>
    </a>
    <a href="{{ url_for('cart') }}" class="{{ 'active' if request.path.startswith('/cart') else '' }}">
        <i class="fas fa-shopping-cart"></i>
        <span>Keranjang</span>
    </a>
    <a href="/profile" class="{{ 'active' if request.path.startswith('/profile') else '' }}">
        <i class="fas fa-user"></i>
        <span>Profil</span>
    </a>
</nav>
{% endblock %}
